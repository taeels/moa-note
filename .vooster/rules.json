{
  "rules": [
    {
      "type": "prd",
      "content": "# ì œí’ˆ ìš”êµ¬ì‚¬í•­ ë¬¸ì„œ (PRD)\n\n## 1. ê°œìš”\nì‹œìŠ¤í…œ ì—”ì§€ë‹ˆì–´ 7ëª…ìœ¼ë¡œ êµ¬ì„±ëœ íŒ€ì´ í•œ ì£¼ ë™ì•ˆ Gerritì— í‘¸ì‹œí•œ ì»¤ë°‹ë“¤ì„ ì¸ì›ë³„ë¡œ ìë™ í´ëŸ¬ìŠ¤í„°ë§Â·ìš”ì•½í•´ 30ì´ˆ ì´ë‚´ë¡œ ì½ì„ ìˆ˜ ìˆëŠ” ì£¼ê°„ ë‹¤ì´ì œìŠ¤íŠ¸ ì›¹í˜ì´ì§€ë¥¼ ì œê³µí•œë‹¤. ìš”ì•½ì€ AIê°€ 2~3ë¬¸ì¥ìœ¼ë¡œ í•µì‹¬ ë³€ê²½ì ì„ ì „ë‹¬í•´ ì˜¤í”„ë¼ì¸ ì½”ë“œë¦¬ë·° ì „ ë¹ ë¥¸ ì‚¬ì „ ì´í•´ë¥¼ ë•ëŠ”ë‹¤.\n\n## 2. ë¬¸ì œ ì •ì˜\n- ì„œë¡œ ë‹¤ë¥¸ ëª¨ë“ˆì„ ë‹´ë‹¹í•´ íŒ¨ì¹˜ ë°°ê²½ ì„¤ëª…ì— ë¦¬ë·° ì‹œê°„ì´ ê³¼ë‹¤ ì†Œìš”  \n- ê¸°ì¡´ Gerrit UIëŠ” ë³€ê²½ ì´ë ¥ì„ í•œëˆˆì— íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€  \n- ì£¼ê°„ ë‹¨ìœ„ë¡œ ë³€ê²½ ë‚´ìš©ì„ ì •ë¦¬Â·í™•ì‚°í•  ìˆ˜ë‹¨ ë¶€ì¬\n\n## 3. ëª©í‘œ ë° ëª©ì \n- 1ì°¨ ëª©í‘œ: 30ì´ˆ ë‚´ ì½ì„ ìˆ˜ ìˆëŠ” ì¸ì›ë³„ ì£¼ê°„ ë‹¤ì´ì œìŠ¤íŠ¸ ìë™ ìƒì„±  \n- ë¶€ì°¨ ëª©í‘œ: ì´ë©”ì¼Â·Excel ë‚´ë³´ë‚´ê¸°, ê³¼ê±° ê¸°ë¡ ë³´ê´€, í´ë¦­ í•œ ë²ˆ ì¬ìƒì„±  \n- ì„±ê³µ ì§€í‘œ  \n  - ì£¼ê°„ ë‹¤ì´ì œìŠ¤íŠ¸ ì—´ëŒë¥  â‰¥ 90%  \n  - ì˜¤í”„ë¼ì¸ ì½”ë“œë¦¬ë·° ì‹œê°„ 20% ë‹¨ì¶•  \n  - ìš”ì•½ ë§Œì¡±ë„(ì„¤ë¬¸) â‰¥ 4/5  \n\n## 4. íƒ€ê¹ƒ ì‚¬ìš©ì\n### ì£¼ìš” ì‚¬ìš©ì\n- ì‹œìŠ¤í…œ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œì(ë¦¬ëˆ…ìŠ¤ ì»¤ë„, íŒì›¨ì–´, LK ë“±)  \n- Gerrit ì‚¬ìš© ê²½í—˜ ë³´ìœ , CLI ì„ í˜¸, ì‹œê°„ ì••ë°• ë†’ìŒ\n### ì´í•´ê´€ê³„ì\n- íŒ€ ë¦¬ë“œ: ë¦¬ë·° íš¨ìœ¨ í–¥ìƒ  \n- DevOps: ì‹œìŠ¤í…œ ìœ ì§€Â·ë°°í¬  \n\n## 5. ì‚¬ìš©ì ìŠ¤í† ë¦¬\n- ê°œë°œìë¡œì„œ, í•œ ì£¼ ë‚´ ë‚´ê°€ ì˜¬ë¦° íŒ¨ì¹˜ë¥¼ 2ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½ë°›ì•„ ë¦¬ë·° ì¤€ë¹„ ì‹œê°„ì„ ì ˆì•½í•˜ê³  ì‹¶ë‹¤.  \n- íŒ€ì›ìœ¼ë¡œì„œ, ë™ë£Œë“¤ì˜ ë³€ê²½ì‚¬í•­ì„ ë¹ ë¥´ê²Œ í›‘ì–´ë³´ê³  ê´€ë ¨ ì´ìŠˆë¥¼ ë¯¸ë¦¬ íŒŒì•…í•˜ê³  ì‹¶ë‹¤.  \n- íŒ€ ë¦¬ë“œë¡œì„œ, íŒ€ ì „ì²´ ë³€ê²½ íŠ¸ë Œë“œë¥¼ íŒŒì•…í•´ ë¦¬ì†ŒìŠ¤ ë°°ë¶„ ê²°ì •ì„ ë¹ ë¥´ê²Œ ë‚´ë¦¬ê³  ì‹¶ë‹¤.  \n\n## 6. ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­\n### í•µì‹¬ ê¸°ëŠ¥\n1. Gerrit í†µí•©\n   - ì£¼ ë‹¨ìœ„(ì›”~ì¼) ì‚¬ìš©ìë³„ ì»¤ë°‹ ë¦¬ìŠ¤íŠ¸ ìˆ˜ì§‘\n   - í•„í„°: í”„ë¡œì íŠ¸/ë¸Œëœì¹˜ ì„ íƒ  \n   - ìŠ¹ì¸ ìƒíƒœ(merged, open ë“±) í‘œì‹œ\n2. ì»¤ë°‹ í´ëŸ¬ìŠ¤í„°ë§\n   - ë™ì¼ í† í”½/íŒŒì¼ ê²½ë¡œÂ·ë©”ì‹œì§€ ìœ ì‚¬ë„ ê¸°ë°˜ ê·¸ë£¹í™”  \n   - ê·¸ë£¹í™” ì‹¤íŒ¨ ì‹œ ë‹¨ì¼ ì»¤ë°‹ìœ¼ë¡œ ì²˜ë¦¬\n   - ìˆ˜ë½ ê¸°ì¤€: 90% ì´ìƒ ê´€ë ¨ë„\n3. AI ìš”ì•½ ìƒì„±\n   - ê·¸ë£¹ë‹¹ 2~3ë¬¸ì¥, 400ì ì´í•˜  \n   - í•µì‹¬ ë³€ê²½ íŒŒì¼/ê¸°ëŠ¥ ì–¸ê¸‰  \n   - ìƒì„± ì‹œê°„ â‰¤ 10ì´ˆ/ê·¸ë£¹\n4. ì›¹ ë‹¤ì´ì œìŠ¤íŠ¸ ë·°\n   - ì‚¬ìš©ìë³„ Accordion UI, ê·¸ë£¹Â·ì»¤ë°‹ í¼ì¹¨/ì ‘í˜  \n   - â€œìƒˆë¡œ ìƒì„±â€ ë²„íŠ¼ìœ¼ë¡œ ì‹¤ì‹œê°„ ê°±ì‹   \n   - ì‹œê°„ ìŠ¤íƒ¬í”„Â·ë²„ì „ í‘œì‹œ\n### ë¶€ê°€ ê¸°ëŠ¥\n- ë‹¤ì´ì œìŠ¤íŠ¸ ì €ì¥ & ê²€ìƒ‰(ë‚ ì§œÂ·ì‘ì„±ì í•„í„°)  \n- ì´ë©”ì¼ ë°œì†¡(HTML) / Excel ë‹¤ìš´ë¡œë“œ(xlsx)  \n- ìš”ì•½ í’ˆì§ˆ í”¼ë“œë°±(ğŸ‘/ğŸ‘) ìˆ˜ì§‘  \n- í–¥í›„: LLM ê¸°ë°˜ ì½”ë“œ í’ˆì§ˆ ë¦¬ë·° ì œì•ˆ  \n\n## 7. ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­\n- ì„±ëŠ¥: ì „ì²´ ë‹¤ì´ì œìŠ¤íŠ¸ ìƒì„± â‰¤ 30ì´ˆ  \n- ë³´ì•ˆ: ì‚¬ë‚´ Git ì ‘ê·¼ í† í° ì•”í˜¸í™” ì €ì¥, ë‚´ë¶€ë§ ì „ìš©  \n- ì‚¬ìš©ì„±: ëª¨ë°”ì¼ ëŒ€ì‘, ë‹¤í¬ ëª¨ë“œ ì§€ì›  \n- í™•ì¥ì„±: íŒ€ ê·œëª¨ 50ëª…ê¹Œì§€ ë¬´ì¤‘ë‹¨ ì§€ì›  \n- í˜¸í™˜: ìµœì‹  Chrome, Edge, Firefox  \n\n## 8. ê¸°ìˆ  ê³ ë ¤ì‚¬í•­\n- ì•„í‚¤í…ì²˜:  \n  - Backend: Python FastAPI + Celery(worker)  \n  - Frontend: React(TypeScript), Ant Design  \n  - AI: ì‚¬ë‚´ LLM(LLama 2) ë˜ëŠ” OpenAI í”„ë¡ì‹œ(ë‹¨, ì™¸ë¶€ ì „ì†¡ ë¶ˆê°€, ìˆ˜ì‹ ë§Œ í—ˆìš©) â†’ LangChain íŒŒì´í”„ë¼ì¸  \n- ë°ì´í„°: Gerrit REST API, GitHub API(ì‚¬ë‚´ ì¸ìŠ¤í„´ìŠ¤ì— í•œí•¨) ìˆ˜ì§‘, PostgreSQL ë©”íƒ€ë°ì´í„° ì €ì¥  \n- ë°°í¬: Kubernetes(on-prem), Helm chart  \n- ì™¸ë¶€ ì˜ì¡´: Gerrit, GitHub(ì‚¬ë‚´), LLM ëª¨ë¸, SMTP, S3(minio)  \n- ë„¤íŠ¸ì›Œí¬: ì™¸ë¶€ ì¸í„°ë„·(ì‚¬ë‚´ë§ ì™¸ë¶€) ì ‘ì† ì‹œ ë°˜ë“œì‹œ ì‚¬ë‚´ í”„ë¡ì‹œ ë° ì‚¬ë‚´ ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•´ì•¼ í•¨. ì‚¬ë‚´ë§ ë‚´ ì„œë¹„ìŠ¤ ê°„ í†µì‹ ì—ëŠ” í•´ë‹¹ ì œì•½ ë¯¸ì ìš©.\n## 9. ì„±ê³µ ì§€í‘œ\n- ì›”ê°„ í™œì„± ì‚¬ìš©ì(MAU)  \n- í‰ê·  ìš”ì•½ ì½ê¸° ì‹œê°„ < 35ì´ˆ  \n- ë¦¬ë·° ë¯¸íŒ… í‰ê·  ê¸¸ì´ ê°ì†Œìœ¨  \n- ìš”ì•½ ì¬ìƒì„± ìš”ì²­ë¥ (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)  \n- ì‹œìŠ¤í…œ ì˜¤ë¥˜ìœ¨ < 1%  \n\n## 10. ì¼ì •Â·ë§ˆì¼ìŠ¤í†¤\n- Phase 1(MVP, 6ì£¼)  \n  - Gerrit ì—°ë™, í´ëŸ¬ìŠ¤í„°ë§, ê¸°ë³¸ ìš”ì•½, ì›¹ ë·°  \n- Phase 2(8ì£¼)  \n  - ì´ë©”ì¼/Excel ë‚´ë³´ë‚´ê¸°, ì´ë ¥ ì €ì¥Â·ê²€ìƒ‰, í”¼ë“œë°± ìˆ˜ì§‘  \n- Phase 3(12ì£¼)  \n  - ì½”ë“œ ë¦¬ë·° ì¶”ì²œ, í”„ë¡œì íŠ¸ ë‹¤ì¤‘ ì„ íƒ, ëŒ€ì‹œë³´ë“œ í†µê³„  \n\n## 11. ìœ„í—˜ ë° ëŒ€ì‘\n- LLM í’ˆì§ˆ ì €í•˜ â†’ í”„ë¡¬í”„íŠ¸ íŠœë‹Â·ëª¨ë¸ êµì²´ ì˜µì…˜ í™•ë³´  \n- Gerrit API ë³€ê²½ â†’ ë²„ì „ ê³ ì •Â·ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸  \n- ìš”ì•½ ì˜¤Â·ëˆ„ë½ â†’ ì‚¬ìš©ì í”¼ë“œë°± ë£¨í”„Â·ëª¨ë¸ ì¬í•™ìŠµ  \n- ë‚´ë¶€ë§ ë°°í¬ ì§€ì—° â†’ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì‚¬ì „ ìºì‹±  \n\n## 12. í–¥í›„ ë°œì „\n- ë©€í‹° ë¦¬í¬ì§€í† ë¦¬(ç¤¾ë‚´ GitLab ë“±) í†µí•©  \n- ìì—°ì–´ ì§ˆì˜í˜• ê²€ìƒ‰ â€œì§€ë‚œë‹¬ ë©”ëª¨ë¦¬ ê´€ë¦¬ íŒ¨ì¹˜ ë³´ì—¬ì¤˜â€  \n- ì¡°ì§ ì „ì²´ DevOps ì§€í‘œì™€ ì—°ê³„í•´ í†µí•© ê°œë°œ ëŒ€ì‹œë³´ë“œ ì™„ì„±",
      "writedAt": "2025-07-09T14:11:50.566Z"
    },
    {
      "type": "architecture",
      "content": "# ê¸°ìˆ  ìš”êµ¬ ì‚¬í•­ ë¬¸ì„œ (TRD)\n\n## 1. ê¸°ìˆ  ì´ê´„ ìš”ì•½\n- **í”„ë¡œì íŠ¸ ê°œìš”**  \n  - Gerrit REST APIë¡œ ì£¼ê°„ ì»¤ë°‹ì„ ìˆ˜ì§‘í•˜ê³ , Python ë°±ì—”ë“œì—ì„œ í´ëŸ¬ìŠ¤í„°ë§Â·AI ìš”ì•½ì„ ìˆ˜í–‰í•˜ì—¬ Next.js í”„ë¡ íŠ¸ì—”ë“œì— 30ì´ˆ ì´ë‚´ ë‹¤ì´ì œìŠ¤íŠ¸ë¥¼ ì œê³µí•œë‹¤.  \n- **í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ**  \n  - Frontend : Next.js (TypeScript) + Ant Design  \n  - Backend : Python 3.11 + FastAPI + Celery + PostgreSQL + Redis  \n  - AI : LangChain íŒŒì´í”„ë¼ì¸ + ì‚¬ë‚´ LLM (Llama 2)  \n  - DevOps : Docker + Kubernetes(on-prem) + Helm  \n- **ì£¼ìš” ê¸°ìˆ  ëª©í‘œ**  \n  - ë‹¤ì´ì œìŠ¤íŠ¸ ìƒì„± ì „ì²´ ì§€ì—° â‰¤ 30ì´ˆ  \n  - ë™ì‹œ ì‚¬ìš©ì 100ëª…, íŒ€ì› 50ëª…ê¹Œì§€ ë¬´ì¤‘ë‹¨  \n  - SSO(Active Directory)ë¡œ ë¬´ë¹„ë°€ë²ˆí˜¸ ì¸ì¦  \n- **ì¤‘ìš” ê¸°ìˆ  ê°€ì •**  \n  - ì™¸ë¶€ ì¸í„°ë„· ì°¨ë‹¨, ëª¨ë“  ì˜ì¡´ ì´ë¯¸ì§€ëŠ” ë‚´ë¶€ Registryì— ë¯¸ë¦¬ ìºì‹±  \n  - LLM í˜¸ì¶œì€ ì‚¬ë‚´ GPU ì„œë²„ë¡œë§Œ í†µì‹   \n\n## 2. ê¸°ìˆ  ìŠ¤íƒ ì•„í‚¤í…ì²˜\n### í”„ë¡ íŠ¸ì—”ë“œ\n- **ì£¼ìš” í”„ë ˆì„ì›Œí¬**: Next.js 14 (App Router)  \n- **ìƒíƒœ ê´€ë¦¬**: React Context + React Query (ì„œë²„ ìƒíƒœ)  \n- **ë¼ìš°íŒ…**: Next.js file-based routing, CSR/SSR í˜¼í•©  \n- **UI/UX í”„ë ˆì„ì›Œí¬**: Ant Design 5 + TailwindCSS (ê²½ëŸ‰ ìŠ¤íƒ€ì¼)  \n- **ë¹Œë“œ ë„êµ¬**: Vite í”ŒëŸ¬ê·¸ì¸ ë‚´ì¥(next-build), ESLint, Prettier, Husky  \n\n### ë°±ì—”ë“œ\n- **ëŸ°íƒ€ì„**: Python 3.11 (uvicorn ASGI)  \n- **ì›¹ í”„ë ˆì„ì›Œí¬**: FastAPI 0.110 + Pydantic v2  \n- **API íŒ¨í„´**: REST JSON, OpenAPI ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±  \n- **ë°ì´í„° ê²€ì¦**: Pydantic ëª¨ë¸ ë ˆì´ì–´  \n- **ë¯¸ë“¤ì›¨ì–´**:  \n  - logging : structlog + python-json-logger  \n  - monitoring : Prometheus FastAPI instrumentator  \n  - auth : OIDC ë¯¸ë“¤ì›¨ì–´(Keycloak AD-sync)  \n\n### ë°ì´í„°ë² ì´ìŠ¤ ë° í¼ì‹œìŠ¤í„´ìŠ¤\n- **ì£¼ DB**: PostgreSQL 15 (JSONB ì§€ì›, íŠ¸ëœì­ì…˜ ì•ˆì •ì„±)  \n- **ìŠ¤í‚¤ë§ˆ ì„¤ê³„**: ì •ê·œí™” 3NF, í•µì‹¬ í…Œì´ë¸” (user, digest, cluster, commit, feedback)  \n- **ìºì‹±**: Redis 7 (Celery broker + ìš”ì•½ ìºì‹œ 10ë¶„ TTL)  \n- **ë§ˆì´ê·¸ë ˆì´ì…˜**: Alembic autogenerate + Git ë²„ì „ ê´€ë¦¬  \n- **ë°±ì—…/ë³µêµ¬**: pg_dump ì•¼ê°„ ìŠ¤ëƒ…ìƒ·, S3(minio) ì €ì¥  \n\n### ì¸í”„ë¼ & DevOps\n- **í˜¸ìŠ¤íŒ…**: ì‚¬ë‚´ Kubernetes 1.28, 3-ë…¸ë“œ ì›Œì»¤(NVMe SSD)  \n- **ì»¨í…Œì´ë„ˆ**: Docker multi-stage ë¹Œë“œ, distroless ì´ë¯¸ì§€  \n- **CI/CD**: GitLab CI íŒŒì´í”„ë¼ì¸ â†’ Helm chart ë°°í¬ â†’ Argo CD ìŠ¹ì¸  \n- **ëª¨ë‹ˆí„°ë§/ê´€ì°°ì„±**: Prometheus + Grafana, Loki ì¤‘ì•™ ë¡œê·¸  \n- **ë¡œê¹… ì „ëµ**: JSON ë¡œê·¸ â†’ Fluent-bit â†’ Loki, ê²½ê³ ëŠ” Alertmanager  \n\n## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„\n### ìµœìƒìœ„ ë¹Œë”© ë¸”ë¡\n- í”„ë¡ íŠ¸ì—”ë“œ (Next.js)  \n  - SSR/CSR í˜¼í•© ë Œë”ë§, SSO í† í° ì €ì¥(HTTP-only cookie)  \n- API ê²Œì´íŠ¸ì›¨ì´ (FastAPI)  \n  - ì¸ì¦, ìš”ì²­ ê²€ì¦, digest ì¡°íšŒ/ìƒì„± ì—”ë“œí¬ì¸íŠ¸  \n- ì›Œì»¤ (Celery)  \n  - Gerrit ë°ì´í„° ìˆ˜ì§‘, í´ëŸ¬ìŠ¤í„°ë§, LLM í˜¸ì¶œ  \n- ë°ì´í„°ë² ì´ìŠ¤ (PostgreSQL + Redis)  \n  - ë©”íƒ€ë°ì´í„° ì €ì¥, ì‘ì—… ìƒíƒœ ìºì‹œ  \n- ì‚¬ë‚´ LLM ì„œë¹„ìŠ¤  \n  - í…ìŠ¤íŠ¸ ìš”ì•½ íŒŒì´í”„ë¼ì¸  \n\n### ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ ìƒí˜¸ì‘ìš© ë‹¤ì´ì–´ê·¸ë¨\n```mermaid\ngraph TD\n    FE[Next.js] --> API[FastAPI]\n    API --> DB[(PostgreSQL)]\n    API --> REDIS[Redis]\n    API --> CELERY[Celery Worker]\n    CELERY --> GERRIT[Gerrit REST API]\n    CELERY --> LLM[Internal LLM]\n```\n- FEëŠ” SSO í† í°ìœ¼ë¡œ APIë¥¼ í˜¸ì¶œí•´ ë‹¤ì´ì œìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì˜¨ë‹¤.  \n- APIëŠ” DB/Redisì—ì„œ ìºì‹œ í™•ì¸ í›„ ì—†ìœ¼ë©´ Celeryì— ì‘ì—…ì„ ë„£ëŠ”ë‹¤.  \n- CeleryëŠ” Gerrit ì»¤ë°‹ì„ ëª¨ì•„ í´ëŸ¬ìŠ¤í„°ë§Â·ìš”ì•½ í›„ DBì— ì €ì¥í•œë‹¤.  \n- ì™„ë£Œ ì‹œ APIëŠ” FEì— ìš”ì•½ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì—¬ í™”ë©´ì— í‘œì‹œí•œë‹¤.  \n\n### ì½”ë“œ ì¡°ì§ ë° ì»¨ë²¤ì…˜\n**ë„ë©”ì¸ ê¸°ë°˜ ì¡°ì§ ì „ëµ**\n- ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ê¸°ì¤€(user, digest, feedback, infra)ë¡œ í´ë” êµ¬ë¶„  \n- ê³„ì¸µ ë¶„ë¦¬: presentation, service, repository, infra  \n- ê³µí†µ ìœ í‹¸ì€ shared ëª¨ë“ˆë¡œ ë¶„ë¦¬  \n\n**ê³µí†µ í´ë” êµ¬ì¡° (ëª¨ë…¸ë ˆí¬)**\n```\n/repo-root\nâ”œâ”€â”€ frontend/\nâ”‚   â”œâ”€â”€ src/\nâ”‚   â”‚   â”œâ”€â”€ components/\nâ”‚   â”‚   â”œâ”€â”€ pages/\nâ”‚   â”‚   â”œâ”€â”€ hooks/\nâ”‚   â”‚   â”œâ”€â”€ services/\nâ”‚   â”‚   â””â”€â”€ utils/\nâ”‚   â”œâ”€â”€ public/\nâ”‚   â””â”€â”€ package.json\nâ”œâ”€â”€ backend/\nâ”‚   â”œâ”€â”€ app/\nâ”‚   â”‚   â”œâ”€â”€ api/\nâ”‚   â”‚   â”œâ”€â”€ domains/\nâ”‚   â”‚   â”‚   â”œâ”€â”€ digest/\nâ”‚   â”‚   â”‚   â”œâ”€â”€ user/\nâ”‚   â”‚   â”‚   â””â”€â”€ feedback/\nâ”‚   â”‚   â”œâ”€â”€ core/\nâ”‚   â”‚   â”œâ”€â”€ workers/\nâ”‚   â”‚   â””â”€â”€ utils/\nâ”‚   â”œâ”€â”€ migrations/\nâ”‚   â””â”€â”€ pyproject.toml\nâ”œâ”€â”€ infrastructure/\nâ”‚   â”œâ”€â”€ docker/\nâ”‚   â”œâ”€â”€ helm/\nâ”‚   â””â”€â”€ scripts/\nâ””â”€â”€ README.md\n```\n\n### ë°ì´í„° íë¦„ & í†µì‹  íŒ¨í„´\n- **í´ë¼ì´ì–¸íŠ¸-ì„œë²„**: HTTPS JSON REST, Bearer JWT(OIDC)  \n- **DB ì¸í„°ë™ì…˜**: SQLModel(ORM) + asyncpg, ì»¤ë„¥ì…˜ í’€ 20ê°œ  \n- **ì™¸ë¶€ ì„œë¹„ìŠ¤**: Gerrit REST API polling, ë‚´ë¶€ LLM gRPC í˜¸ì¶œ  \n- **ì‹¤ì‹œê°„ í†µì‹ **: í•„ìš” ì—†ìŒ(ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼), SSE ì˜ˆë¹„ ì˜µì…˜  \n- **ë°ì´í„° ë™ê¸°í™”**: Celery ì™„ë£Œ í›„ Redis pub/sub â†’ API ìºì‹œ ë¬´íš¨í™”  \n\n## 4. ì„±ëŠ¥ ìµœì í™” ì „ëµ\n- ì¿¼ë¦¬ ìµœì í™”: INDEX(commit_id, author, week) ì„ í–‰ ì ìš©  \n- ìºì‹±: ìš”ì•½ ê²°ê³¼ë¥¼ Redis ì— 10ë¶„ ì €ì¥, ë‹¤ì´ì œìŠ¤íŠ¸ ì¬ìƒì„± ì‹œ ë¬´íš¨í™”  \n- ë¹„ë™ê¸° ì²˜ë¦¬: AI ìš”ì•½Â·í´ëŸ¬ìŠ¤í„°ë§ì€ Celery GPU ì›Œì»¤ì—ì„œ ë¶„ë¦¬ ìˆ˜í–‰  \n- í”„ëŸ°íŠ¸ ë²ˆë“¤ ìµœì í™”: ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…, ì´ë¯¸ì§€ lazy-load, gzip ì••ì¶•  \n\n## 5. êµ¬í˜„ ë¡œë“œë§µ & ë§ˆì¼ìŠ¤í†¤\n### Phase 1 (MVP, 6ì£¼)\n- Kubernetes ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·Helm ì°¨íŠ¸ ê¸°ë°˜ ì¸í”„ë¼ êµ¬ì¶•  \n- SSO ë¡œê·¸ì¸, Gerrit ë°ì´í„° ìˆ˜ì§‘, ê¸°ë³¸ í´ëŸ¬ìŠ¤í„°ë§Â·ìš”ì•½  \n- ì‚¬ìš©ìë³„ ë‹¤ì´ì œìŠ¤íŠ¸ ë·°(Accordion UI)  \n- CI/CD íŒŒì´í”„ë¼ì¸ ì´ˆê¸°í™” â†’ dev ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìë™ ë°°í¬  \n\n### Phase 2 (ê¸°ëŠ¥ ê°•í™”, 8ì£¼)\n- ì´ë©”ì¼(HTML) ë°œì†¡, Excel(xlsx) ë‹¤ìš´ë¡œë“œ  \n- ìš”ì•½ í”¼ë“œë°±(ğŸ‘/ğŸ‘) ì €ì¥, ì´ë ¥ ê²€ìƒ‰ í•„í„° ì¶”ê°€  \n- Prometheus ë©”íŠ¸ë¦­ + Grafana ëŒ€ì‹œë³´ë“œ  \n- ì„±ëŠ¥ íŠœë‹(ì¿¼ë¦¬, ìºì‹œ, ì›Œì»¤ ìŠ¤ì¼€ì¼ë§)  \n\n### Phase 3 (í™•ì¥Â·ìµœì í™”, 12ì£¼)\n- ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ì„ íƒ, í†µê³„ ëŒ€ì‹œë³´ë“œ  \n- ì½”ë“œ ë¦¬ë·° ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜(LLM)  \n- ë‹¤ì¤‘ íŒ€(100ëª…) ì§€ì›, HPA ìŠ¤ì¼€ì¼ë§  \n- ê°ì‚¬ ë¡œê·¸, ì •ì±… ê¸°ë°˜ ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸  \n\n## 6. ìœ„í—˜ í‰ê°€ & ì™„í™” ì „ëµ\n### ê¸°ìˆ  ìœ„í—˜\n- LLM ì˜¤ë‹µë¥  ìƒìŠ¹ â†’ í”„ë¡¬í”„íŠ¸ íŠœë‹, ëª¨ë¸ ë²„ì „ ë¡¤ë°± íƒœê·¸  \n- Gerrit API ë³€ê²½ â†’ ë²„ì „ ê³ ì •, í…ŒìŠ¤íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ì „ ê²€ì¦  \n- ì„±ëŠ¥ ë³‘ëª©(ì›Œì»¤) â†’ ì›Œì»¤ ìˆ˜í‰ ìŠ¤ì¼€ì¼, GPU í• ë‹¹ ìµœì í™”  \n- SSO í†µí•© ì‹¤íŒ¨ â†’ Keycloak í”„ë¡ì‹œë¡œ LDAP fallback  \n\n### í”„ë¡œì íŠ¸ ìœ„í—˜\n- ì¼ì • ì§€ì—° â†’ ì£¼ê°„ ìŠ¤í”„ë¦°íŠ¸ ë¦¬ë·°, ê¸°ëŠ¥ ë²”ìœ„ ì¡°ì •  \n- ë¦¬ì†ŒìŠ¤ ë¶€ì¡± â†’ ì›Œì»¤ ì»¨í…Œì´ë„ˆ auto-scaling, ì™¸ì£¼ ë¶ˆí•„ìš”  \n- í’ˆì§ˆ ì €í•˜ â†’ SonarQube ì •ì  ë¶„ì„, 80% ì´ìƒ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€  \n- ë°°í¬ ì¥ì•  â†’ ë¸”ë£¨-ê·¸ë¦° ë°°í¬, Helm rollback ìë™í™”  \n\n---",
      "writedAt": "2025-07-09T14:11:50.567Z"
    },
    {
      "type": "guideline",
      "content": "# Code Guideline Document\n\n---\n\n## 1. Project Overview\n\nThis project delivers a weekly digest web application that automatically clusters and summarizes Gerrit commits per team member, leveraging AI for concise, actionable summaries. The core stack includes:\n\n- **Frontend:** Next.js 14 (TypeScript), Ant Design 5, TailwindCSS, React Context, React Query\n- **Backend:** Python 3.11, FastAPI, Celery, Pydantic v2, PostgreSQL 15, Redis 7\n- **AI:** Internal LLM (Llama 2) via LangChain pipeline\n- **Infrastructure:** Docker, Kubernetes (on-prem), Helm, GitLab CI/CD\n\nKey architectural decisions:\n- Domain-driven folder structure (user, digest, feedback, infra)\n- Clear separation of presentation, service, repository, and infra layers\n- RESTful API with OpenAPI schema, JWT-based OIDC authentication\n- Async processing for AI summarization via Celery workers\n- Caching and state management via Redis, React Query\n\n---\n\n## 2. Core Principles\n\n1. **Single Responsibility:** Every module/class/function MUST have exactly one clear responsibility.\n2. **Explicitness:** All code MUST be explicit in intent; avoid implicit behavior or hidden side effects.\n3. **Consistency:** Follow established naming, structure, and style conventions across the codebase.\n4. **Testability:** All business logic MUST be unit-testable and covered by automated tests.\n5. **Security First:** Sensitive data (e.g., tokens) MUST be handled securely; never hard-code secrets.\n\n---\n\n## 3. Language-Specific Guidelines\n\n### 3.1 TypeScript (Next.js Frontend)\n\n- **File Organization**\n  - MUST organize by domain: `/src/components/`, `/src/pages/`, `/src/hooks/`, `/src/services/`, `/src/utils/`\n  - Each React component in its own file; group related components in folders.\n  - Shared types/interfaces in `/src/types/`.\n- **Import/Dependency Management**\n  - MUST use absolute imports from `src/` root.\n  - MUST import only used modules; avoid entire library imports (e.g., `import { Button } from 'antd'` not `import * as antd from 'antd'`).\n  - Third-party dependencies MUST be declared in `package.json` and updated via PR.\n- **Error Handling**\n  - All async calls (e.g., fetch, API) MUST use `try/catch`.\n  - Errors from services/hooks MUST propagate meaningful messages.\n\n```typescript\n// MUST: Clear async error handling in a service\nexport async function fetchDigest(userId: string) {\n  try {\n    const res = await fetch(`/api/digest/${userId}`);\n    if (!res.ok) throw new Error('Failed to fetch digest');\n    return await res.json();\n  } catch (e) {\n    // Log and rethrow for UI handling\n    console.error(e);\n    throw e;\n  }\n}\n```\n\n```typescript\n// MUST NOT: Swallowing errors or ignoring async failures\nexport async function fetchDigest(userId: string) {\n  const res = await fetch(`/api/digest/${userId}`);\n  // No error handling\n  return res.json(); // This may fail silently\n}\n```\n\n### 3.2 Python (FastAPI Backend)\n\n- **File Organization**\n  - MUST use `/app/domains/` for business logic grouped by domain (e.g., `/digest/`, `/user/`, `/feedback/`)\n  - `/app/api/` for route definitions; `/app/core/` for shared infrastructure; `/app/utils/` for helpers.\n  - Each model/schema in its own file.\n- **Import/Dependency Management**\n  - MUST use absolute imports within the app.\n  - Third-party dependencies MUST be listed in `pyproject.toml`.\n  - Circular imports MUST be avoided.\n- **Error Handling**\n  - MUST handle all external API/database calls with `try/except`.\n  - API endpoints MUST return standardized error responses (HTTPException with detail).\n\n```python\n# MUST: Proper error handling in a repository method\nfrom fastapi import HTTPException\n\ndef get_digest_by_user(db, user_id: int):\n    try:\n        digest = db.query(Digest).filter_by(user_id=user_id).first()\n        if not digest:\n            raise HTTPException(status_code=404, detail=\"Digest not found\")\n        return digest\n    except Exception as e:\n        # Log and return 500 error\n        logger.exception(\"DB error\")\n        raise HTTPException(status_code=500, detail=\"Internal server error\")\n```\n\n```python\n# MUST NOT: Unhandled exceptions or generic catch-alls\ndef get_digest_by_user(db, user_id: int):\n    return db.query(Digest).filter_by(user_id=user_id).first()\n    # No error handling, may leak stacktrace or crash worker\n```\n\n---\n\n## 4. Code Style Rules\n\n### 4.1 MUST Follow\n\n- **TypeScript**\n  - MUST use strict typing (`noImplicitAny`, `strictNullChecks`).\n  - MUST use functional components and React Hooks.\n  - MUST use ESLint and Prettier; code MUST pass lint and formatting checks before merge.\n  - MUST destructure props and state for clarity.\n  - Rationale: Enforces type safety, readability, and maintainability.\n\n```typescript\n// MUST: Typed functional component and prop destructuring\ntype DigestProps = { digest: DigestSummary };\nconst DigestCard: React.FC<DigestProps> = ({ digest }) => (\n  <Card>\n    <p>{digest.summary}</p>\n  </Card>\n);\n```\n\n- **Python**\n  - MUST use type hints for all functions and methods.\n  - MUST use Pydantic models for all input/output schemas.\n  - MUST document all public functions and classes with docstrings.\n  - MUST use Black and isort for formatting and import order.\n  - Rationale: Ensures code clarity, schema validation, and uniform style.\n\n```python\n# MUST: Function with type hints and docstring\ndef summarize_commits(commits: List[Commit]) -> str:\n    \"\"\"\n    Generate a summary for the provided list of commits.\n    \"\"\"\n    ...\n```\n\n### 4.2 MUST NOT Do\n\n- MUST NOT write multi-responsibility modules (e.g., service, model, and API in one file).\n- MUST NOT use any/unknown in TypeScript except when absolutely necessary and justified.\n- MUST NOT use magic numbers/strings; define constants in a shared location.\n- MUST NOT commit commented-out code or unused imports.\n- MUST NOT block the event loop in FastAPI or Celery (e.g., synchronous I/O in async routes).\n- MUST NOT use complex, ad-hoc state management patterns; always use React Context or React Query.\n\n```typescript\n// MUST NOT: Multi-responsibility file\n// Contains API call, state management, and UI in one file â€“ split these concerns!\n```\n\n```python\n# MUST NOT: Synchronous DB call in async endpoint\n@app.get(\"/digest\")\nasync def get_digest():\n    digest = db.query(Digest).all()  # BAD: blocks event loop\n    return digest\n```\n\n---\n\n## 5. Architecture Patterns\n\n### 5.1 Component/Module Structure\n\n- **Frontend**\n  - MUST organize by domain: components, hooks, services, utils.\n  - Each UI component MUST be reusable and stateless where possible.\n  - Shared state MUST be managed via React Context or React Query.\n- **Backend**\n  - MUST separate API (route), service (business logic), repository (DB access), and infra (external services).\n  - Each domain folder MUST include models, schemas, and services.\n\n```typescript\n// MUST: Example folder structure\n/src/digest/\n  â”œâ”€â”€ DigestCard.tsx\n  â”œâ”€â”€ useDigest.ts\n  â”œâ”€â”€ digestService.ts\n  â””â”€â”€ types.ts\n```\n\n```python\n# MUST: Example backend domain module\n/app/domains/digest/\n  â”œâ”€â”€ models.py\n  â”œâ”€â”€ schemas.py\n  â”œâ”€â”€ service.py\n  â””â”€â”€ repository.py\n```\n\n### 5.2 Data Flow Patterns\n\n- **Frontend**\n  - All server data fetching MUST use React Query for caching and revalidation.\n  - Local UI state (e.g., Accordion open/close) MUST use useState/useReducer.\n- **Backend**\n  - API endpoints MUST validate input with Pydantic models.\n  - Service layer handles business logic; repository layer handles DB.\n  - Celery tasks MUST be idempotent and log status.\n\n```typescript\n// MUST: Data fetching pattern\nconst { data, error } = useQuery(['digest', userId], () => fetchDigest(userId));\n```\n\n### 5.3 State Management Conventions\n\n- **Frontend**\n  - Global app state (e.g., user, theme) MUST use React Context.\n  - Server state (e.g., digests, feedback) MUST use React Query.\n  - MUST NOT use Redux or other state libraries unless justified.\n- **Backend**\n  - Application state MUST NOT be stored in memory; use Redis/PostgreSQL.\n  - Task status and cache MUST use Redis with defined TTL.\n\n### 5.4 API Design Standards\n\n- All endpoints MUST be RESTful, use nouns for resources, and support standard HTTP methods.\n- All responses MUST follow a consistent envelope: `{ data, error, meta }`.\n- All endpoints MUST be documented via OpenAPI (FastAPI auto-docs).\n- All errors MUST return appropriate HTTP status codes and messages.\n\n```python\n# MUST: API response envelope\n@app.get(\"/digest/{user_id}\", response_model=DigestResponse)\nasync def get_digest(user_id: int):\n    try:\n        digest = await service.get_digest(user_id)\n        return {\"data\": digest, \"error\": None, \"meta\": {\"requested_at\": datetime.utcnow()}}\n    except HTTPException as e:\n        return {\"data\": None, \"error\": str(e.detail), \"meta\": {}}\n```\n\n---\n\n## 6. Quality Criteria\n\n- All code MUST be reviewed and pass automated lint, format, and test checks before merge.\n- All business logic MUST have â‰¥80% unit test coverage.\n- All sensitive operations MUST be logged (excluding secrets).\n- All external API calls MUST have error handling and timeouts.\n- All code MUST be written in English, including comments, identifiers, and documentation.\n\n---\n\n**This guideline is the definitive reference for all code in this project. Adherence is mandatory for code quality, maintainability, and team velocity.**",
      "writedAt": "2025-07-09T14:11:50.567Z"
    }
  ]
}